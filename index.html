<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Ain't No Party Like a Third-Party JS Party</title>

		<meta name="author" content="Rebecca Murphey">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/simple.css" id="theme">
    <link rel="stylesheet" type="text/css" href="css/rmurphey.css">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/docco.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Ain&rsquo;t No Party&nbsp;Like a Third&#8209;Party JS&nbsp;Party</h1>
          <p class="author">
            <a href="http://rmurphey.com">Rebecca Murphey</a> / <a href="https://twitter.com/rmurphey">@rmurphey</a>
          </p>
          <p class="author">
            jQuery Conference / San Diego 2014
          </p>
				</section>

        <section>
          <h1>wtf3pjs</h1>
          <p class="author">
            <a href="http://rmurphey.com">Rebecca Murphey</a> / <a href="https://twitter.com/rmurphey">@rmurphey</a>
          </p>
          <p class="author">
            jQuery Conference / San Diego 2014
          </p>
        </section>

				<section>
					<img src="img/bv.jpg" style="margin-left:-60px">
				</section>

				<section>
					<h4>Firebird</h4>
					<iframe src="./examples/agileville.html" width="800" height="500" style="border: 1px solid #d0d0d0"></iframe>
					<ul class="actions">
						<li><a href="./examples/agileville.html" target="_blank">view full frame</a></li>
						<li><a href="view-source:localhost:8000/examples/agileville.html" target="_blank">view source</a></li>
					</ul>
				</section>

				<section>
					<img src="img/bv-network-requests.png">

					<dl>
						<dt>bvapi.js</dt>
						<dd>the &ldquo;scout&rdquo; file</dd>

						<dl>
							<dt>bv-primary.js</dt>
							<dd>latest version of the core app</dd>

							<dl>
								<dt>magpie.js</dt>
								<dd>analytics</dd>

								<dt>secondary.js</dt>
								<dd>lazy-loaded resources</dd>
							</dl>

							<dt>batch.json</dt>
							<dd>all the data</dd>
						</dl>

					</dl>

          <p style="clear:both" class="note">Read more about scout files and <a href="https://alexsexton.com/blog/2013/03/deploying-javascript-applications/">deploying JS apps</a> from Alex Sexton.</p>
				</section>

				<section>
					<h2>We have one <code>&lt;script&gt;</code> tag.</h2>
				</section>

				<section>
					<h2>Our code must Just Workâ„¢ &hellip;</h2>
				</section>

				<section>
					<h2>&hellip; even when customers <strike>do&nbsp;something&nbsp;crazy</strike> find new and exciting ways to keep me employed.</h2>
				</section>

        <section>
          <ul>
            <li>modified native objects</li>
            <li>various JS libraries</li>
            <li>various plugins of varying quality</li>
            <li>various back-end systems</li>
          </ul>
        </section>





        <section data-state="title"></section>





				<section>
					<section data-state="title">
						<h2>$.getScript().andDeleteIt()</h2>
					</section>

          <section class="bug">
            <h2>bug report</h2>
            <h3>the application is only loading intermittently</h3>
          </section>

					<section>
						<pre><code data-trim>
&lt;script src="//display.bazaarvoice.com/static/Agileville/en_US/bvapi.js"&gt;&lt/script&gt;
						</code></pre>
					</section>

					<section>
						<h4></h4>
						<pre><code data-trim>
$.getScript('//display.bazaarvoice.com/static/Agileville/en_US/bvapi.js');
						</code></pre>
					</section>

					<section>
						<iframe src="http://jsbin.com/AtIQIRet/latest/embed?js,output" class="jsbin"></iframe>
					</section>

          <section>
            <pre><code data-trim>
var scripts = document.getElementsByTagName('script');
var firstScript = scripts[0];

// later ...

var anotherScript = document.createElement('script');
anotherScript.src = '//display.ugc.bazaarvoice.com/Agileville/bv-primary.js';

firstScript.parentNode.appendChild(anotherScript);
            </code></pre>
            <br>
            <h4>uh oh.</h4>
          </section>

					<section>
            <h4>the fix:</h4>
						<pre><code data-trim>
var scripts = document.getElementsByTagName('script');
var firstScript = scripts[0];
var firstScriptParentNode = firstScript.parentNode;

// later ...

var anotherScript = document.createElement('script');
anotherScript.src = '//display.ugc.bazaarvoice.com/Agileville/bv-primary.js';

firstScriptParentNode.appendChild(anotherScript);
						</code></pre>
					</section>
				</section>






				<section>
					<section data-state="title">
						<h2>body double</h2>
					</section>

          <section class="bug">
            <h2>bug report</h2>
            <h3>the review submission form appears twice</h3>
          </section>

					<section>
            <iframe src="http://jsbin.com/EJEwAYI/latest/embed?js,output" class="jsbin"></iframe>
					</section>

          <section>
            <iframe src="http://jsbin.com/EJEwAYI/latest/embed?js,output,html" class="jsbin"></iframe>
          </section>

          <section>
            <pre><code data-trim>
$('body').length; // lol 2
            </code></pre>
          </section>

          <section>
            <h4>the fix:</h4>
            <pre><code data-trim>
function getBody (document) {
  return document.body || document.getElementsByTagName('body')[0];
};
            </code></pre>
          </section>
				</section>





				<section>
					<section data-state="title">
						<h2>undefined</h2>
					</section>

          <section class="bug">
            <h2>bug report</h2>
            <h3>a firebird component fails to display when it should</h3>
          </section>

					<section>
            <iframe src="http://jsbin.com/UFurogOm/latest/embed?js,output" class="jsbin"></iframe>
					</section>

          <section>
            <iframe src="http://jsbin.com/UFurogOm/latest/embed?js,output,html" class="jsbin"></iframe>
          </section>

          <section>
            <h4>the fix:</h4>
            <pre><code data-trim>
function showIt (config) {
  var myDiv = config.containerId && $('#' + config.containerId);

  if (myDiv && myDiv.length) {
    myDiv.append('<p>using configured div</p>');
  } else {
    $('#fallback').append('<p>using fallback div</p>');
  }
}

$('#showIt').click(function () {
  showIt({ productId : 1234 });
});
            </code></pre>
          </section>
				</section>





        <section>
          <section data-state="title">
            <h2>keypressn&rsquo;t</h2>
          </section>

          <section class="bug">
            <h2>bug report</h2>
            <h3>typing in review submission form doesn&rsquo;t have any effect</h3>
          </section>

          <section>
            <iframe src="http://jsbin.com/OsOrOHI/latest/embed?output" class="jsbin"></iframe>
          </section>

          <section>
            <iframe src="http://jsbin.com/OsOrOHI/latest/embed?output,js" class="jsbin"></iframe>
          </section>

          <section>
            <h4>the fix: change yr code</h4>
            <pre><code data-trim>
function writeReview () {
  $BV.on('submissionLoad', function () {
    togglePopup();
  });
}
            </code></pre>
          </section>
        </section>




				<section>
					<section data-state="title">
						<h2>lessons</h2>
					</section>

          <section>
            <h2>code defensively &mdash; <br>even if you&rsquo;re first-party</h2>
          </section>

          <section>
            <h2>plan for chaos</h2>
            <pre><code data-trim>
window.exports = {
  testing : 'all the things',
  breaking : 'code in funky ways',
  haikus : 'add more fun'
};
            </code></pre>
          </section>

          <section>
            <h2>there&rsquo;s stuff you can&rsquo;t catch; enable urgent debugging</h2>
            <p style="clear:both" class="note">I&rsquo;ll be talking more about this at the <a href="http://www.feopsconf.com/">Front End Ops Conference</a> in April.</p>
          </section>
				</section>





        <section>
          <a href="http://bazaarvoice.com"><img src="img/bv.jpg" style="margin-left:-70px;"></a>

          <img class="avatar" src="img/rebecca-murphey.jpg">
          <img class="avatar" src="img/andrew-dupont.jpg">
          <img class="avatar" src="img/dan-heberden.jpeg">
          <img class="avatar" src="img/brian-arnold.jpeg">

          <p><a href="http://rmurphey.com">Rebecca Murphey</a></p>
          <p><a href="https://twitter.com/rmurphey">@rmurphey</a></p>
          <p><a href="http://rmurphey.com/wtf3pjs/">rmurphey.com/wtf3pjs</a></p>
        </section>


			</div>



		</div>


		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: 'none', // Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});


		</script>

	</body>
</html>
